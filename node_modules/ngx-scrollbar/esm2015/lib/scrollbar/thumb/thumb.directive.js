/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, Inject, ElementRef } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { RtlScrollAxisType } from '@angular/cdk/platform';
import { Directionality } from '@angular/cdk/bidi';
import { NgScrollbar } from '../../ng-scrollbar';
import { ThumbAdapter } from './thumb';
export class ThumbXDirective extends ThumbAdapter {
    /**
     * @param {?} cmp
     * @param {?} element
     * @param {?} document
     * @param {?} dir
     */
    constructor(cmp, element, document, dir) {
        super(cmp, element.nativeElement, document);
        this.cmp = cmp;
        this.element = element;
        this.document = document;
        this.dir = dir;
    }
    /**
     * @protected
     * @return {?}
     */
    get clientProperty() {
        return 'clientX';
    }
    /**
     * @protected
     * @return {?}
     */
    get pageProperty() {
        return 'pageX';
    }
    /**
     * @protected
     * @return {?}
     */
    get viewportScrollSize() {
        return this.cmp.viewport.scrollWidth;
    }
    /**
     * @protected
     * @return {?}
     */
    get viewportScrollOffset() {
        return this.cmp.viewport.scrollLeft;
    }
    /**
     * @return {?}
     */
    get viewportScrollMax() {
        return this.cmp.viewport.scrollMaxX;
    }
    /**
     * @return {?}
     */
    get dragStartOffset() {
        return this.clientRect.left;
    }
    /**
     * @return {?}
     */
    get size() {
        return this.thumbElement.clientWidth;
    }
    /**
     * @protected
     * @param {?} position
     * @param {?} size
     * @return {?}
     */
    updateStyles(position, size) {
        this.thumbElement.style.width = `${size}px`;
        this.thumbElement.style.transform = `translate3d(${position}px, 0, 0)`;
    }
    /**
     * @protected
     * @param {?} position
     * @param {?} scrollMax
     * @return {?}
     */
    handleDrag(position, scrollMax) {
        if (this.dir.value === 'rtl') {
            if (this.cmp.manager.rtlScrollAxisType === RtlScrollAxisType.NEGATED) {
                return position - scrollMax;
            }
            if (this.cmp.manager.rtlScrollAxisType === RtlScrollAxisType.INVERTED) {
                return scrollMax - position;
            }
            // Keeping this as a memo
            // if (this.rtlScrollAxisType === RtlScrollAxisType.NORMAL) {
            //   return position;
            // }
        }
        return position;
    }
    /**
     * @protected
     * @param {?} position
     * @param {?} trackMax
     * @return {?}
     */
    handleDirection(position, trackMax) {
        if (this.dir.value === 'rtl') {
            if (this.cmp.manager.rtlScrollAxisType === RtlScrollAxisType.INVERTED) {
                return -position;
            }
            if (this.cmp.manager.rtlScrollAxisType === RtlScrollAxisType.NORMAL) {
                return position - trackMax;
            }
            // Keeping this as a memo
            // if (this.rtlScrollAxisType === RtlScrollAxisType.NEGATED) {
            //   return position;
            // }
        }
        return position;
    }
    /**
     * @protected
     * @param {?} value
     * @return {?}
     */
    setDragging(value) {
        this.cmp.setDragging({ horizontalDragging: value });
    }
    /**
     * @protected
     * @param {?} position
     * @return {?}
     */
    scrollTo(position) {
        this.cmp.viewport.scrollXTo(position);
    }
}
ThumbXDirective.decorators = [
    { type: Directive, args: [{ selector: '[scrollbarThumbX]' },] }
];
/** @nocollapse */
ThumbXDirective.ctorParameters = () => [
    { type: NgScrollbar },
    { type: ElementRef },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
    { type: Directionality }
];
if (false) {
    /**
     * @type {?}
     * @protected
     */
    ThumbXDirective.prototype.cmp;
    /**
     * @type {?}
     * @protected
     */
    ThumbXDirective.prototype.element;
    /**
     * @type {?}
     * @protected
     */
    ThumbXDirective.prototype.document;
    /**
     * @type {?}
     * @protected
     */
    ThumbXDirective.prototype.dir;
}
export class ThumbYDirective extends ThumbAdapter {
    /**
     * @param {?} cmp
     * @param {?} element
     * @param {?} document
     */
    constructor(cmp, element, document) {
        super(cmp, element.nativeElement, document);
        this.cmp = cmp;
        this.element = element;
        this.document = document;
    }
    /**
     * @protected
     * @return {?}
     */
    get pageProperty() {
        return 'pageY';
    }
    /**
     * @protected
     * @return {?}
     */
    get viewportScrollSize() {
        return this.cmp.viewport.scrollHeight;
    }
    /**
     * @protected
     * @return {?}
     */
    get viewportScrollOffset() {
        return this.cmp.viewport.scrollTop;
    }
    /**
     * @return {?}
     */
    get viewportScrollMax() {
        return this.cmp.viewport.scrollMaxY;
    }
    /**
     * @protected
     * @return {?}
     */
    get clientProperty() {
        return 'clientY';
    }
    /**
     * @return {?}
     */
    get dragStartOffset() {
        return this.clientRect.top;
    }
    /**
     * @return {?}
     */
    get size() {
        return this.thumbElement.clientHeight;
    }
    /**
     * @protected
     * @param {?} position
     * @param {?} size
     * @return {?}
     */
    updateStyles(position, size) {
        this.thumbElement.style.height = `${size}px`;
        this.thumbElement.style.transform = `translate3d(0px, ${position}px, 0)`;
    }
    /**
     * @protected
     * @param {?} position
     * @return {?}
     */
    handleDrag(position) {
        return position;
    }
    /**
     * @protected
     * @param {?} position
     * @return {?}
     */
    handleDirection(position) {
        return position;
    }
    /**
     * @protected
     * @param {?} value
     * @return {?}
     */
    setDragging(value) {
        this.cmp.setDragging({ verticalDragging: value });
    }
    /**
     * @protected
     * @param {?} position
     * @return {?}
     */
    scrollTo(position) {
        this.cmp.viewport.scrollYTo(position);
    }
}
ThumbYDirective.decorators = [
    { type: Directive, args: [{ selector: '[scrollbarThumbY]' },] }
];
/** @nocollapse */
ThumbYDirective.ctorParameters = () => [
    { type: NgScrollbar },
    { type: ElementRef },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
if (false) {
    /**
     * @type {?}
     * @protected
     */
    ThumbYDirective.prototype.cmp;
    /**
     * @type {?}
     * @protected
     */
    ThumbYDirective.prototype.element;
    /**
     * @type {?}
     * @protected
     */
    ThumbYDirective.prototype.document;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGh1bWIuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LXNjcm9sbGJhci8iLCJzb3VyY2VzIjpbImxpYi9zY3JvbGxiYXIvdGh1bWIvdGh1bWIuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQzFELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNuRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDakQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUd2QyxNQUFNLE9BQU8sZUFBZ0IsU0FBUSxZQUFZOzs7Ozs7O0lBOEIvQyxZQUFzQixHQUFnQixFQUNoQixPQUFtQixFQUNELFFBQWEsRUFDL0IsR0FBbUI7UUFDdkMsS0FBSyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsYUFBYSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBSnhCLFFBQUcsR0FBSCxHQUFHLENBQWE7UUFDaEIsWUFBTyxHQUFQLE9BQU8sQ0FBWTtRQUNELGFBQVEsR0FBUixRQUFRLENBQUs7UUFDL0IsUUFBRyxHQUFILEdBQUcsQ0FBZ0I7SUFFekMsQ0FBQzs7Ozs7SUFqQ0QsSUFBYyxjQUFjO1FBQzFCLE9BQU8sU0FBUyxDQUFDO0lBQ25CLENBQUM7Ozs7O0lBRUQsSUFBYyxZQUFZO1FBQ3hCLE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUM7Ozs7O0lBRUQsSUFBYyxrQkFBa0I7UUFDOUIsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUM7SUFDdkMsQ0FBQzs7Ozs7SUFFRCxJQUFjLG9C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R0FBRyxDQUFDLFdBQVcsQ0FBQyxFQUFFLGdCQUFnQixFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDcEQsQ0FBQzs7Ozs7O0lBRVMsUUFBUSxDQUFDLFFBQWdCO1FBQ2pDLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN4QyxDQUFDOzs7WUF6REYsU0FBUyxTQUFDLEVBQUUsUUFBUSxFQUFFLG1CQUFtQixFQUFFOzs7O1lBdkZuQyxXQUFXO1lBSlEsVUFBVTs0Q0E0SHZCLE1BQU0sU0FBQyxRQUFROzs7Ozs7O0lBRmhCLDhCQUEwQjs7Ozs7SUFDMUIsa0NBQTZCOzs7OztJQUM3QixtQ0FBeUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEluamVjdCwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFJ0bFNjcm9sbEF4aXNUeXBlIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL3BsYXRmb3JtJztcclxuaW1wb3J0IHsgRGlyZWN0aW9uYWxpdHkgfSBmcm9tICdAYW5ndWxhci9jZGsvYmlkaSc7XHJcbmltcG9ydCB7IE5nU2Nyb2xsYmFyIH0gZnJvbSAnLi4vLi4vbmctc2Nyb2xsYmFyJztcclxuaW1wb3J0IHsgVGh1bWJBZGFwdGVyIH0gZnJvbSAnLi90aHVtYic7XHJcblxyXG5ARGlyZWN0aXZlKHsgc2VsZWN0b3I6ICdbc2Nyb2xsYmFyVGh1bWJYXScgfSlcclxuZXhwb3J0IGNsYXNzIFRodW1iWERpcmVjdGl2ZSBleHRlbmRzIFRodW1iQWRhcHRlciB7XHJcblxyXG4gIHByb3RlY3RlZCBnZXQgY2xpZW50UHJvcGVydHkoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiAnY2xpZW50WCc7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZ2V0IHBhZ2VQcm9wZXJ0eSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuICdwYWdlWCc7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZ2V0IHZpZXdwb3J0U2Nyb2xsU2l6ZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbFdpZHRoO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGdldCB2aWV3cG9ydFNjcm9sbE9mZnNldCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbExlZnQ7XHJcbiAgfVxyXG5cclxuICBnZXQgdmlld3BvcnRTY3JvbGxNYXgoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxNYXhYO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGRyYWdTdGFydE9mZnNldCgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY2xpZW50UmVjdC5sZWZ0O1xyXG4gIH1cclxuXHJcbiAgZ2V0IHNpemUoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLnRodW1iRWxlbWVudC5jbGllbnRXaWR0aDtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBjbXA6IE5nU2Nyb2xsYmFyLFxyXG4gICAgICAgICAgICAgIHByb3RlY3RlZCBlbGVtZW50OiBFbGVtZW50UmVmLFxyXG4gICAgICAgICAgICAgIEBJbmplY3QoRE9DVU1FTlQpIHByb3RlY3RlZCBkb2N1bWVudDogYW55LFxyXG4gICAgICAgICAgICAgIHByb3RlY3RlZCBkaXI6IERpcmVjdGlvbmFsaXR5KSB7XHJcbiAgICBzdXBlcihjbXAsIGVsZW1lbnQubmF0aXZlRWxlbWVudCwgZG9jdW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIHVwZGF0ZVN0eWxlcyhwb3NpdGlvbjogbnVtYmVyLCBzaXplOiBudW1iZXIpIHtcclxuICAgIHRoaXMudGh1bWJFbGVtZW50LnN0eWxlLndpZHRoID0gYCR7c2l6ZX1weGA7XHJcbiAgICB0aGlzLnRodW1iRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHtwb3NpdGlvbn1weCwgMCwgMClgO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGhhbmRsZURyYWcocG9zaXRpb246IG51bWJlciwgc2Nyb2xsTWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKHRoaXMuZGlyLnZhbHVlID09PSAncnRsJykge1xyXG4gICAgICBpZiAodGhpcy5jbXAubWFuYWdlci5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuTkVHQVRFRCkge1xyXG4gICAgICAgIHJldHVybiBwb3NpdGlvbiAtIHNjcm9sbE1heDtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5jbXAubWFuYWdlci5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuSU5WRVJURUQpIHtcclxuICAgICAgICByZXR1cm4gc2Nyb2xsTWF4IC0gcG9zaXRpb247XHJcbiAgICAgIH1cclxuICAgICAgLy8gS2VlcGluZyB0aGlzIGFzIGEgbWVtb1xyXG4gICAgICAvLyBpZiAodGhpcy5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuTk9STUFMKSB7XHJcbiAgICAgIC8vICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgICAvLyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaGFuZGxlRGlyZWN0aW9uKHBvc2l0aW9uOiBudW1iZXIsIHRyYWNrTWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgaWYgKHRoaXMuZGlyLnZhbHVlID09PSAncnRsJykge1xyXG4gICAgICBpZiAodGhpcy5jbXAubWFuYWdlci5ydGxTY3JvbGxBeGlzVHlwZSA9PT0gUnRsU2Nyb2xsQXhpc1R5cGUuSU5WRVJURUQpIHtcclxuICAgICAgICByZXR1cm4gLXBvc2l0aW9uO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmNtcC5tYW5hZ2VyLnJ0bFNjcm9sbEF4aXNUeXBlID09PSBSdGxTY3JvbGxBeGlzVHlwZS5OT1JNQUwpIHtcclxuICAgICAgICByZXR1cm4gcG9zaXRpb24gLSB0cmFja01heDtcclxuICAgICAgfVxyXG4gICAgICAvLyBLZWVwaW5nIHRoaXMgYXMgYSBtZW1vXHJcbiAgICAgIC8vIGlmICh0aGlzLnJ0bFNjcm9sbEF4aXNUeXBlID09PSBSdGxTY3JvbGxBeGlzVHlwZS5ORUdBVEVEKSB7XHJcbiAgICAgIC8vICAgcmV0dXJuIHBvc2l0aW9uO1xyXG4gICAgICAvLyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgc2V0RHJhZ2dpbmcodmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIHRoaXMuY21wLnNldERyYWdnaW5nKHsgaG9yaXpvbnRhbERyYWdnaW5nOiB2YWx1ZSB9KTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBzY3JvbGxUbyhwb3NpdGlvbjogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxYVG8ocG9zaXRpb24pO1xyXG4gIH1cclxufVxyXG5cclxuQERpcmVjdGl2ZSh7IHNlbGVjdG9yOiAnW3Njcm9sbGJhclRodW1iWV0nIH0pXHJcbmV4cG9ydCBjbGFzcyBUaHVtYllEaXJlY3RpdmUgZXh0ZW5kcyBUaHVtYkFkYXB0ZXIge1xyXG5cclxuICBwcm90ZWN0ZWQgZ2V0IHBhZ2VQcm9wZXJ0eSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuICdwYWdlWSc7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZ2V0IHZpZXdwb3J0U2Nyb2xsU2l6ZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY21wLnZpZXdwb3J0LnNjcm9sbEhlaWdodDtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBnZXQgdmlld3BvcnRTY3JvbGxPZmZzZXQoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxUb3A7XHJcbiAgfVxyXG5cclxuICBnZXQgdmlld3BvcnRTY3JvbGxNYXgoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNtcC52aWV3cG9ydC5zY3JvbGxNYXhZO1xyXG4gIH1cclxuXHJcbiAgcHJvdGVjdGVkIGdldCBjbGllbnRQcm9wZXJ0eSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuICdjbGllbnRZJztcclxuICB9XHJcblxyXG4gIGdldCBkcmFnU3RhcnRPZmZzZXQoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmNsaWVudFJlY3QudG9wO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHNpemUoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLnRodW1iRWxlbWVudC5jbGllbnRIZWlnaHQ7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY21wOiBOZ1Njcm9sbGJhcixcclxuICAgICAgICAgICAgICBwcm90ZWN0ZWQgZWxlbWVudDogRWxlbWVudFJlZixcclxuICAgICAgICAgICAgICBASW5qZWN0KERPQ1VNRU5UKSBwcm90ZWN0ZWQgZG9jdW1lbnQ6IGFueSkge1xyXG4gICAgc3VwZXIoY21wLCBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQsIGRvY3VtZW50KTtcclxuICB9XHJcblxyXG5cclxuICBwcm90ZWN0ZWQgdXBkYXRlU3R5bGVzKHBvc2l0aW9uOiBudW1iZXIsIHNpemU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy50aHVtYkVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZX1weGA7XHJcbiAgICB0aGlzLnRodW1iRWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoMHB4LCAke3Bvc2l0aW9ufXB4LCAwKWA7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaGFuZGxlRHJhZyhwb3NpdGlvbjogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIHJldHVybiBwb3NpdGlvbjtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBoYW5kbGVEaXJlY3Rpb24ocG9zaXRpb246IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgc2V0RHJhZ2dpbmcodmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIHRoaXMuY21wLnNldERyYWdnaW5nKHsgdmVydGljYWxEcmFnZ2luZzogdmFsdWUgfSk7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgc2Nyb2xsVG8ocG9zaXRpb246IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy5jbXAudmlld3BvcnQuc2Nyb2xsWVRvKHBvc2l0aW9uKTtcclxuICB9XHJcbn1cclxuIl19